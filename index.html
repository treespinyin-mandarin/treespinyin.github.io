<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±‰å­—ä¸‡è¯æœç´¢åº“</title>
    <script src="https://cdnjs.cloudflare.com"></script>
    <style>
        :root { --main: #27ae60; }
        body { font-family: sans-serif; background: #f9f9f9; margin: 0; padding: 15px; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .search-area { position: sticky; top: 0; background: white; padding: 10px 0; z-index: 10; }
        input { width: 100%; padding: 14px; border: 2px solid #eee; border-radius: 8px; font-size: 16px; outline: none; box-sizing: border-box; }
        input:focus { border-color: var(--main); }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th { background: var(--main); color: white; padding: 12px; text-align: left; }
        td { padding: 12px; border-bottom: 1px solid #f0f0f0; }
        .char { font-size: 1.6em; font-weight: bold; }
        .status { text-align: center; color: #999; margin-top: 20px; font-size: 0.8em; }
    </style>
</head>
<body>
<div class="container">
    <h1>ğŸ“š æ±‰å­—ä¸‡è¯åº“</h1>
    <div class="search-area">
        <input type="text" id="searchInput" placeholder="ğŸ” æœæ±‰å­—ã€æ‹¼éŸ³æˆ–è‹±æ–‡...">
    </div>
    <table id="wordTable">
        <thead><tr><th>æ±‰å­—</th><th>æ‹¼éŸ³</th><th>æ„æ€</th><th>ç»„è¯</th><th>é€ å¥</th></tr></thead>
        <tbody id="tbody"><tr><td colspan="5" id="loader" style="text-align:center;">æ­£åœ¨åŒæ­¥äº‘ç«¯æ•°æ®ï¼Œè¯·ç¨å€™...</td></tr></tbody>
    </table>
    <div id="countInfo" class="status"></div>
</div>

<script>
    let wordsData = [];
    
    function init() {
        if (typeof Papa === 'undefined') { setTimeout(init, 100); return; }
        
        // æ ¸å¿ƒæ”¹åŠ¨ï¼šå°è¯•ç›´æ¥ä»åŸŸåæ ¹è·¯å¾„è¯»å–ï¼Œå¢åŠ å¤±è´¥åçš„å…·ä½“æŠ¥é”™
        Papa.parse("/data/words.csv", {
            download: true,
            header: true,
            skipEmptyLines: true,
            encoding: "UTF-8",
            complete: function(results) {
                // æ¸…ç†è¡¨å¤´ç©ºæ ¼
                wordsData = results.data.map(item => {
                    let clean = {};
                    for (let key in item) { clean[key.trim()] = item[key]; }
                    return clean;
                });
                if(wordsData.length > 0) {
                    render(wordsData);
                    document.getElementById('countInfo').innerText = `å·²åŠ è½½ ${wordsData.length} ä¸ªè¯æ¡`;
                } else {
                    document.getElementById('loader').innerText = "âš ï¸ è¯»åˆ°äº†æ–‡ä»¶ï¼Œä½†é‡Œé¢å¥½åƒæ²¡å†…å®¹ï¼Ÿ";
                }
            },
            error: function(err) {
                // å¦‚æœ /data è¯»ä¸åˆ°ï¼Œå°è¯• data (ç›¸å¯¹è·¯å¾„)
                console.log("å°è¯•å¤‡ç”¨è·¯å¾„...");
                Papa.parse("data/words.csv", {
                    download: true, header: true, skipEmptyLines: true,
                    complete: function(res) { render(res.data); }
                });
                document.getElementById('loader').innerHTML = `âŒ æ— æ³•è¯»å– data/words.csv<br>è¯·ç¡®ä¿åŸŸå/${window.location.pathname.split('/')[1]}/data/words.csv å¯ä»¥è®¿é—®`;
            }
        });
    }

    function render(list) {
        const tbody = document.getElementById('tbody');
        tbody.innerHTML = list.slice(0, 300).map(item => `
            <tr>
                <td class="char">${item.æ±‰å­— || '-'}</td>
                <td style="color:#d35400"><b>${item.æ‹¼éŸ³ || '-'}</b></td>
                <td style="color:#2980b9">${item.è‹±æ–‡å«ä¹‰ || '-'}</td>
                <td><b>${item.ç»„è¯ || '-'}</b><br><small>${item.ç»„è¯è‹±æ–‡ || ''}</small></td>
                <td style="font-size:0.9em">${item.é€ å¥ || '-'}<br><i style="color:#666">${item.é€ å¥è‹±æ–‡ || ''}</i></td>
            </tr>
        `).join('');
    }

    document.getElementById('searchInput').addEventListener('input', function(e) {
        const val = e.target.value.trim().toUpperCase();
        const filtered = wordsData.filter(item => 
            Object.values(item).some(s => String(s).toUpperCase().includes(val))
        );
        render(filtered);
        document.getElementById('countInfo').innerText = `æ£€ç´¢åˆ° ${filtered.length} ä¸ªè¯æ±‡`;
    });

    init();
</script>
</body>
</html>
