<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±‰å­—åº“æœç´¢</title>
    <!-- å¼•å…¥ PapaParse -->
    <script src="https://cdnjs.cloudflare.com"></script>
    <style>
        body { font-family: sans-serif; margin: 20px; background: #f4f7f6; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        input { width: 100%; padding: 15px; margin: 20px 0; border: 2px solid #4CAF50; border-radius: 5px; font-size: 18px; box-sizing: border-box; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px; border: 1px solid #eee; text-align: left; }
        th { background: #4CAF50; color: white; }
        .pinyin { color: #e67e22; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>æ±‰å­—æœç´¢åº“</h1>
        <input type="text" id="searchInput" placeholder="ğŸ” è¾“å…¥æ±‰å­—ã€æ‹¼éŸ³æˆ–è‹±æ–‡ç›´æ¥æœç´¢...">
        <table id="wordTable">
            <thead>
                <tr><th>æ±‰å­—</th><th>æ‹¼éŸ³</th><th>å«ä¹‰</th><th>ç»„è¯</th><th>é€ å¥</th></tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script>
        (function init() {
            // è§£å†³ "Papa is not defined" çš„æ ¸å¿ƒé€»è¾‘ï¼šå¾ªç¯æ£€æŸ¥åº“æ˜¯å¦åŠ è½½
            if (typeof Papa === 'undefined') {
                console.log("æ­£åœ¨ç­‰å¾…åº“åŠ è½½...");
                setTimeout(init, 100); 
                return;
            }

            let dictionary = [];
            const searchInput = document.getElementById('searchInput');
            const tbody = document.querySelector('#wordTable tbody');

            // è¯»å–æ•°æ®
            Papa.parse("_data/words.csv", {
                download: true,
                header: true,
                skipEmptyLines: true,
                complete: function(results) {
                    dictionary = results.data;
                    render(dictionary);
                    console.log("æ•°æ®åŠ è½½æˆåŠŸï¼");
                }
            });

            function render(data) {
                tbody.innerHTML = data.map(row => `
                    <tr>
                        <td><b style="font-size:1.5em">${row.æ±‰å­— || ''}</b></td>
                        <td class="pinyin">${row.æ‹¼éŸ³ || ''}</td>
                        <td>${row.è‹±æ–‡å«ä¹‰ || ''}</td>
                        <td>${row.ç»„è¯ || ''}<br><small>(${row.ç»„è¯è‹±æ–‡ || ''})</small></td>
                        <td>${row.é€ å¥ || ''}<br><small style="color:#666">${row.é€ å¥è‹±æ–‡ || ''}</small></td>
                    </tr>
                `).join('');
            }

            searchInput.addEventListener('input', function() {
                const term = this.value.toUpperCase();
                const filtered = dictionary.filter(row => 
                    Object.values(row).some(val => String(val).toUpperCase().includes(term))
                );
                render(filtered);
            });
        })();
    </script>
</body>
</html>
