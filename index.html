<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±‰å­—ä¸‡è¯æœç´¢åº“</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        :root { --main: #27ae60; --bg: #f4f7f6; }
        body { font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif; background: var(--bg); margin: 0; padding: 15px; color: #333; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 25px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); }
        h1 { text-align: center; color: var(--main); margin-bottom: 20px; }
        
        .search-area { position: sticky; top: 0; background: white; padding: 15px 0; z-index: 10; border-bottom: 1px solid #eee; }
        input { width: 100%; padding: 16px; border: 2px solid #e0e0e0; border-radius: 12px; font-size: 18px; outline: none; transition: all 0.3s; box-sizing: border-box; }
        input:focus { border-color: var(--main); box-shadow: 0 0 8px rgba(39, 174, 96, 0.2); }

        .table-wrapper { overflow-x: auto; margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; min-width: 600px; }
        th { background: var(--main); color: white; padding: 15px; text-align: left; position: sticky; top: 0; }
        td { padding: 15px; border-bottom: 1px solid #f0f0f0; line-height: 1.6; }
        
        .char { font-size: 2em; font-weight: bold; color: #2c3e50; }
        .pinyin { color: #d35400; font-weight: bold; font-size: 1.1em; }
        .english { color: #2980b9; font-weight: 500; }
        .status { text-align: center; color: #7f8c8d; margin-top: 20px; font-size: 0.9em; padding: 20px; }
        
        /* ç®€å•åŠ¨ç”» */
        tr { transition: background 0.2s; }
        tr:hover { background: #f9fffb; }
        @media (max-width: 600px) { .char { font-size: 1.5em; } td { padding: 10px; font-size: 14px; } }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ“š æ±‰å­—ä¸‡è¯åº“</h1>
    
    <div class="search-area">
        <input type="text" id="searchInput" placeholder="ğŸ” è¾“å…¥æ±‰å­—ã€æ‹¼éŸ³æˆ–è‹±æ–‡å«ä¹‰æœç´¢...">
    </div>

    <div class="table-wrapper">
        <table id="wordTable">
            <thead>
                <tr>
                    <th>æ±‰å­—</th>
                    <th>æ‹¼éŸ³</th>
                    <th>æ„æ€ (English)</th>
                    <th>ç»„è¯ & è§£é‡Š</th>
                </tr>
            </thead>
            <tbody id="tbody">
                <tr><td colspan="4" id="loader" style="text-align:center; padding: 40px;">â³ æ­£åœ¨åŠªåŠ›åŠ è½½äº‘ç«¯è¯åº“...</td></tr>
            </tbody>
        </table>
    </div>
    <div id="countInfo" class="status"></div>
</div>

<script>
    let wordsData = [];

    // æ™ºèƒ½è·å–æ•°æ®è·¯å¾„
    function getCsvPath() {
        // å¦‚æœæ˜¯è‡ªå®šä¹‰åŸŸåï¼Œé€šå¸¸åœ¨æ ¹ç›®å½•ï¼›å¦‚æœæ˜¯ github.io/repoï¼Œéœ€è¦ç›¸å¯¹è·¯å¾„
        return "data/words.csv"; 
    }

    function init() {
        if (typeof Papa === 'undefined') {
            setTimeout(init, 200);
            return;
        }

        Papa.parse(getCsvPath(), {
            download: true,
            header: true,
            skipEmptyLines: true,
            encoding: "UTF-8",
            complete: function(results) {
                // è‡ªåŠ¨æ¸…ç†é”®åä¸­çš„ç©ºæ ¼
                wordsData = results.data.map(row => {
                    let newRow = {};
                    Object.keys(row).forEach(key => newRow[key.trim()] = row[key]);
                    return newRow;
                });

                if(wordsData.length > 0) {
                    render(wordsData);
                    document.getElementById('countInfo').innerText = `âœ… æˆåŠŸåŠ è½½ ${wordsData.length} ä¸ªè¯æ¡`;
                } else {
                    showError("âš ï¸ æ–‡ä»¶å·²æ‰¾åˆ°ï¼Œä½†å†…å®¹è§£æä¸ºç©ºï¼Œè¯·æ£€æŸ¥ CSV æ ¼å¼ã€‚");
                }
            },
            error: function(err) {
                console.error("åŠ è½½å¤±è´¥:", err);
                showError("âŒ æ— æ³•è¯»å– data/words.csvã€‚è¯·æ£€æŸ¥ï¼š<br>1. æ–‡ä»¶å¤¹åæ˜¯å¦ä¸ºå°å†™ data<br>2. æ–‡ä»¶åæ˜¯å¦ä¸º words.csv");
            }
        });
    }

    function showError(msg) {
        document.getElementById('loader').innerHTML = `<span style="color: #e74c3c;">${msg}</span>`;
    }

    function render(list) {
        const tbody = document.getElementById('tbody');
        if (list.length === 0) {
            tbody.innerHTML = '<tr><td colspan="4" style="text-align:center; padding:30px;">æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ç»“æœ ğŸ˜…</td></tr>';
            return;
        }

        // ä»…æ¸²æŸ“å‰ 200 æ¡ä»¥ä¿è¯æ€§èƒ½ï¼Œæœç´¢æ—¶ä¼šè‡ªåŠ¨æ›´æ–°
        const displayList = list.slice(0, 200);
        
        tbody.innerHTML = displayList.map(item => `
            <tr>
                <td class="char">${item.æ±‰å­— || '-'}</td>
                <td><span class="pinyin">${item.æ‹¼éŸ³ || '-'}</span></td>
                <td><span class="english">${item.è‹±æ–‡å«ä¹‰ || '-'}</span></td>
                <td>
                    <strong>${item.ç»„è¯ || '-'}</strong><br>
                    <small style="color:#666">${item.é€ å¥ || '-'}</small>
                </td>
            </tr>
        `).join('');
    }

    // æœç´¢è¿‡æ»¤ï¼ˆé˜²æŠ–å¤„ç†æå‡æ€§èƒ½ï¼‰
    let timer;
    document.getElementById('searchInput').addEventListener('input', function(e) {
        clearTimeout(timer);
        timer = setTimeout(() => {
            const val = e.target.value.trim().toLowerCase();
            const filtered = wordsData.filter(item => 
                Object.values(item).some(s => String(s).toLowerCase().includes(val))
            );
            render(filtered);
            document.getElementById('countInfo').innerText = `æ‰¾åˆ° ${filtered.length} ä¸ªåŒ¹é…é¡¹`;
        }, 200);
    });

    init();
</script>

</body>
</html>
